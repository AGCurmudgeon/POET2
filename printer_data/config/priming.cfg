[gcode_macro prime_active_tool]
gcode:
  CHIP_PURGE

## Chip purge macro swiped from doomcube discord. can't remember the author or channel :(
[gcode_macro CHIP_PURGE]
gcode:
    {% set purge_x = params.X_LOC|default(170)|float %}
    {% set purge_y = params.Y_LOC|default(50)|float %}
    G92 E0                          
    G90                            ; absolute positioning    
    G1 E4.0 F3600
    G1 Z10 F3000                   ; move nozzle away from bed
    G1 X{purge_x} Y{purge_y} Z10 F5000.0        ; Move to start position
    G1 X{purge_x} Y{purge_y} Z17 E60 F30
    G1 X{purge_x} Y{purge_y} Z10
    M106 S255
    G4 P7500
    M106 S0
    G1 X{purge_x} Y{purge_y} Z10
